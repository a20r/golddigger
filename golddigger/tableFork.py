
import sqlite3

train_query = "select * from main.train"
test_query = "select * from main.test"

full_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
full_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

ov_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
ov_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

ts_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
ts_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

com_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
com_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

cat_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_brand, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
cat_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_brand, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

brand_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
brand_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

ts30_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
ts30_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

vis30_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
vis30_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_company_180, has_bought_company_q_180, has_bought_company_a_180, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

l90_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
l90_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_company_90, has_bought_company_q_90, has_bought_company_a_90, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

l60_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
l60_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_company_60, has_bought_company_q_60, has_bought_company_a_60, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

l30_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
l30_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_company, never_bought_category, never_bought_brand, has_bought_brand_company_category, has_bought_brand_category, has_bought_brand_company, offer_value, total_spend_all, total_spend_ccb, has_bought_company, has_bought_company_q, has_bought_company_a, has_bought_company_30, has_bought_company_q_30, has_bought_company_a_30, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

com_vis30_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
com_vis30_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

com_vis30_ts30_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
com_vis30_ts30_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

com_ts30_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
com_ts30_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_60, has_bought_brand_q_60, has_bought_brand_a_60, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_60d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

com_r_l60_train_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.train"
com_r_l60_test_query = "SELECT label, repeattrips, id, offer_id, market, chain, never_bought_category, never_bought_brand, has_bought_brand_category, offer_value, total_spend_all, total_spend_ccb, has_bought_category, has_bought_category_q, has_bought_category_a, has_bought_category_30, has_bought_category_q_30, has_bought_category_a_30, has_bought_category_60, has_bought_category_q_60, has_bought_category_a_60, has_bought_category_90, has_bought_category_q_90, has_bought_category_a_90, has_bought_category_180, has_bought_category_q_180, has_bought_category_a_180, has_bought_brand, has_bought_brand_q, has_bought_brand_a, has_bought_brand_30, has_bought_brand_q_30, has_bought_brand_a_30, has_bought_brand_90, has_bought_brand_q_90, has_bought_brand_a_90, has_bought_brand_180, has_bought_brand_q_180, has_bought_brand_a_180, total_spend_30, dep_spend_30, dep_count_30, visits_30, prodid_spend_30, prodid_count_30, prodid_spend_all, prodid_count_all, prodid_spend_corr, marketshare_in_cat, share_of_cust_bought_prod, share_prod_spend, share_of_cust_bought_cat, share_cat_spend, avg_price_per_cheapest_common_unit, avg_price_per_most_common_unit, marketshare_in_dep, share_of_cust_bought_dep, share_dep_spend, seasonal_spend_rate_30d, seasonal_spend_rate_30d_notrend, price_quantile, price_median_compare, price_mean_compare, price_median_difference, repeat_buy_prob_30d, repeat_buy_prob_90d, competing_products_in_cat, marketshare_dominant_prod_in_cat, bought_product_before, established_product, probability_of_60d_buy_in_category, num_distinct_products_in_cat_bought, only_bought_our_product, days_since_first_transaction, returned_product, days_from_lastdata_until_offerdate FROM main.test"

class DataTable(object):

    def __init__(self):
        self.train_query = cat_train_query
        self.test_query = cat_test_query
        self.db = "data1/data.db"

    def load(self, num_groups=1):
        self.inputs = list()
        self.outputs = list()
        self.test_inputs = list()
        self.test_ids = list()
        self.group_inputs = [list() for _ in xrange(num_groups)]
        self.group_outputs = [list() for _ in xrange(num_groups)]
        self.holdout_inputs = list()
        self.holdout_outputs = list()
        self.unseen_inputs = list()
        self.unseen_outputs = list()
        self.sample_weights = [list() for _ in xrange(num_groups)]

        with sqlite3.connect(self.db) as conn:
            cursor = conn.cursor()
            features_train = cursor.execute(self.train_query)
            for i, feature_vector in enumerate(features_train):
                f_vector = list(feature_vector)
                repeater = f_vector[0]
                sw = f_vector[1]
                del f_vector[2]
                del f_vector[1]
                del f_vector[0]
                self.inputs.append(f_vector)
                self.outputs.append(repeater)

                if i % (num_groups + 1) == 0:
                    self.holdout_inputs.append(f_vector)
                    self.holdout_outputs.append(repeater)
                elif i % (num_groups + 2) == 0:
                    self.unseen_inputs.append(f_vector)
                    self.unseen_outputs.append(repeater)
                else:
                    self.group_inputs[i % num_groups].append(f_vector)
                    self.group_outputs[i % num_groups].append(repeater)
                    self.sample_weights[i % num_groups].append(sw)

            features_test = cursor.execute(self.test_query)
            for feature_vector in features_test:
                f_vector = list(feature_vector)
                self.test_ids.append(f_vector[2])
                del f_vector[2]
                del f_vector[1]
                del f_vector[0]
                self.test_inputs.append(f_vector)

        return self

    def get_holdout_inputs(self):
        return self.holdout_inputs

    def get_holdout_outputs(self):
        return self.holdout_outputs

    def get_unseen_inputs(self):
        return self.unseen_inputs

    def get_unseen_outputs(self):
        return self.unseen_outputs

    def get_all_training_inputs(self):
        return self.inputs

    def get_all_training_outputs(self):
        return self.outputs

    def get_training_inputs(self, group):
        return self.group_inputs[group]

    def get_training_outputs(self, group):
        return self.group_outputs[group]

    def get_test_inputs(self):
        return self.test_inputs

    def get_test_ids(self):
        return self.test_ids
